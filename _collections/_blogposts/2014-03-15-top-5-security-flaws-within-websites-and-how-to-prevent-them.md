---
title: Top 5 security flaws within websites and how to prevent them
tags:
  - encryption
  - exploit
  - hacking
  - sql injection
  - xss
  - web
  - security
  - vulnerability
description: Sample code demonstrating how to loop over any collection type in Jekyll
ogDescription: Sample code demonstrating how to loop over any collection type in Jekyll
---

{% include archived-post.md %}

<article id="post-62" class="post-62 post type-post status-publish format-standard hentry category-programming tag-application tag-cross tag-encryption tag-exploit tag-hacking tag-injection tag-php tag-prevention tag-scripting tag-security tag-service tag-site tag-sql tag-vulnerability tag-web tag-xss">
			<div class="entry-content">
		<div class="getsocial gs-inline-group"></div>
<p><br><a href="http://localhost:81/wordpress/wp-content/uploads/2014/03/web-exploits.png"><img class="alignnone size-full wp-image-156" alt="web-exploits" src="http://localhost:81/wordpress/wp-content/uploads/2014/03/web-exploits.png" width="560" height="250"></a></p>
<p>So we’re now into 2014 and websites are starting to become way more advanced by implementing new technologies such as AJAX, fancy web forms and even web sockets.&nbsp;However, little do webmaster’s realise that they’re opening a space for huge security flaws within their websites / web applications / web services for malicious hackers to take advantage of.&nbsp;It could be that a hacker wants to take down your service just for the fun of it, or maybe you’ve become a serious business competitor of theirs and so they want to take down your service as soon as possible so they start making more sales. Or maybe a hacker just thinks they have balls because they can actually do this kinda thing behind a keyboard – when in fact they’d probably soil themselves right in front of you if you tracked them down and confronted them asking why they hacked your website :p</p>
<p>There are many reasons why you should be extremely cautious about web security, but that isn’t what this post is about – so let’s move on.</p>
<p>In this post I will discuss the top 5 security flaws I see way too often on the web. I will also give some pointers on how to learn more about these exploits and fix them so your web applications no longer get hacked.</p>
<p><span id="more-62"></span><br>
<strong><strong>Security flaw #</strong>5:</strong></p>
<h3>Ajax security exploits</h3>
<p>Ajax is a cool technology, but one major problem with it is that people who are implementing it into their websites don’t really understand some of the potential security flaws that pop up from using it.</p>
<p>One rule when creating backend systems:</p>
<blockquote><p>Never allow user input… If you do, clean the input or do some sort of error checking with it so that it isn’t possible for users to perform malicious operations on your web server!</p></blockquote>
<p>You should always keep this rule in mind when developing backend code.</p>
<p><strong>Sample ajax exploit vulnerability</strong></p>
<p>Recently, I was messing around with a pretty cool theme changer I found on a website showing off HTML 5 and CSS3 website designs. The website itself looked fantastic, but it’s coding turned out to be a nightmare… I decided to take a look at how the theme changer worked, and to my surprise, it turned out that it sent out an ajax request that set a cookie, followed by another ajax request to read a php file directly from the server’s disk, included it into the page so that the PHP pre-processor rendered it on the fly and then used Javascript&nbsp;to append the rendered html to the page’s DOM. <strong>This may seem like a clever method of creating such a script, but this is extremely unsafe</strong>.</p>
<p>I was able to perform a <a href="http://en.wikipedia.org/wiki/Directory_traversal_attack" target="_blank">Directory Traversal Attack</a> on the server and display the entire contents of it just by going up a few directories. <strong>A hacker could do a lot with information about your server, and could potentially screw things up so you have no option but to completely rebuild your server.</strong></p>
<p>Assuming the vulnerable script looked something like this:</p>
<div id="wpshdo_1" class="wp-synhighlighter-outer"><div id="wpshdt_1" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_1"></a><a id="wpshat_1" class="wp-synhighlighter-title" href="#codesyntax_1" onclick="javascript:wpsh_toggleBlock(1)" title="Click to show/hide code block">vulnerable-script.php (server side)</a></td><td align="right"><a href="#codesyntax_1" onclick="javascript:wpsh_code(1)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_1" onclick="javascript:wpsh_print(1)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_1" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;"><span class="kw2">&lt;?php</span>
<span class="re0">$template</span> <span class="sy0">=</span> <span class="st_h">'html5-green-theme.php'</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">(</span><a href="http://www.php.net/isset"><span class="kw3">isset</span></a><span class="br0">(</span><span class="re0">$_COOKIE</span><span class="br0">[</span><span class="st_h">'TEMPLATE'</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>
<span class="re0">$template</span> <span class="sy0">=</span> <span class="re0">$_COOKIE</span><span class="br0">[</span><span class="st_h">'TEMPLATE'</span><span class="br0">]</span><span class="sy0">;</span>
<span class="kw1">include</span> <span class="br0">(</span><span class="st0">"/home/users/username/public/templates/"</span> <span class="sy0">.</span> <span class="re0">$template</span><span class="br0">)</span><span class="sy0">;</span>
<span class="sy1">?&gt;</span></pre></div></div>
<p>I could send the following http web request along with a modified cookie (making the server think that this is a genuine request):</p>
<div id="wpshdo_2" class="wp-synhighlighter-outer"><div id="wpshdt_2" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_2"></a><a id="wpshat_2" class="wp-synhighlighter-title" href="#codesyntax_2" onclick="javascript:wpsh_toggleBlock(2)" title="Click to show/hide code block">HTTP request exploiting the vulnerable file</a></td><td align="right"><a href="#codesyntax_2" onclick="javascript:wpsh_code(2)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_2" onclick="javascript:wpsh_print(2)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_2" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;">GET <span class="sy0">/</span>vulnerable<span class="sy0">-</span>script<span class="sy0">.</span>php HTTP<span class="sy0">/</span><span class="nu19">1.0</span>
Cookie<span class="sy0">:</span> TEMPLATE<span class="sy0">=../../../../../../../../../</span>etc<span class="sy0">/</span>passwd</pre></div></div>
<p>Boom! We are now able to read any file on a server, or display users of the server – making it easier for us to hack other things.</p>
<p><strong>Advice on how to fix this security flaw:</strong></p>
<p>Just don’t use a cookie for implementing this type of functionality. A simple solution to this problem would be just storing the source of the html file in a database field, rather than reading the file directly from a disk. If you must use an include in this way though, just add some validation for checking if the script should be allowed to include files from a certain directory or something.</p>
<p>&nbsp;</p>
<p><strong><strong>Security flaw #</strong>4:</strong></p>
<h3>SQL injections</h3>
<p>One of the most common attacks on websites is SQL injections. You’d think by now that they’d finally start to disappear, but people still tend to forget about them or use deprecated functions (functions that should no longer be used as there are better solutions available) and so huge security holes are opened up to user &amp; application data!</p>
<p><strong>Examples of an SQL injection attack:</strong></p>
<p>There is a fantastic wiki entry on <a href="http://en.wikipedia.org/wiki/SQL_injection">SQL injections</a>, so I’m just going to <a href="http://en.wikipedia.org/wiki/SQL_injection">link you there</a> instead.</p>
<p>All I’m saying is don’t create queries like this, or you’re just asking for trouble:<br>
</p><div id="wpshdo_3" class="wp-synhighlighter-outer"><div id="wpshdt_3" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_3"></a><a id="wpshat_3" class="wp-synhighlighter-title" href="#codesyntax_3" onclick="javascript:wpsh_toggleBlock(3)" title="Click to show/hide code block">Vulnerable SQL code</a></td><td align="right"><a href="#codesyntax_3" onclick="javascript:wpsh_code(3)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_3" onclick="javascript:wpsh_print(3)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_3" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;">SELECT <span class="sy0">*</span> FROM users WHERE email <span class="sy0">=</span> <span class="st_h">'$someVariable'</span><span class="sy0">;</span></pre></div></div><p></p>
<p>Why you ask? read the wiki entry, it’ll explain SQL injection to you way better than I will.</p>
<p><strong>Advice on how to fix SQL injection security flaws:</strong></p>
<ul>
<li>Use prepared statements for your queries. Prepared statements are safer than using the standard mysql() functions as they automatically filter user inputs wherever you specify. PDO is an Object Orientated abstraction of native database drivers, so it’s compatible with many database technologies (not just mysql). This makes managing your code easier if you ever decide to port your script for another DBMS software.</li>
</ul>
<div id="wpshdo_4" class="wp-synhighlighter-outer"><div id="wpshdt_4" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_4"></a><a id="wpshat_4" class="wp-synhighlighter-title" href="#codesyntax_4" onclick="javascript:wpsh_toggleBlock(4)" title="Click to show/hide code block">PDO database query</a></td><td align="right"><a href="#codesyntax_4" onclick="javascript:wpsh_code(4)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_4" onclick="javascript:wpsh_print(4)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_4" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;"><span class="co1">// Instantiate a new PDO object</span>
<span class="re0">$db</span> <span class="sy0">=</span> <span class="kw2">new</span> PDO<span class="br0">(</span><span class="st_h">'mysql:dbname=user_management;host=localhost'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="co1">// Prepare a query for being escaped</span>
<span class="re0">$statement</span> <span class="sy0">=</span> <span class="re0">$db</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="st_h">'SELECT * FROM users WHERE email = :email'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="co1">// execute the query, passing in the parameters to replace</span>
<span class="re0">$statement</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><a href="http://www.php.net/array"><span class="kw3">array</span></a><span class="br0">(</span><span class="st_h">':email'</span> <span class="sy0">=&gt;</span> <span class="re0">$email</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
<span class="co1">// fetch results as array</span>
<span class="re0">$results</span> <span class="sy0">=</span> <span class="re0">$statement</span><span class="sy0">-&gt;</span><span class="me1">fetchAll</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<ul>
<li>Turn off errors from the php configuration, or just be lazy and use the following code at the top of your source files:</li>
</ul>
<div id="wpshdo_5" class="wp-synhighlighter-outer"><div id="wpshdt_5" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_5"></a><a id="wpshat_5" class="wp-synhighlighter-title" href="#codesyntax_5" onclick="javascript:wpsh_toggleBlock(5)" title="Click to show/hide code block">Turn off PHP error reporting</a></td><td align="right"><a href="#codesyntax_5" onclick="javascript:wpsh_code(5)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_5" onclick="javascript:wpsh_print(5)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_5" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;"><span class="kw2">&lt;?php</span>
	<a href="http://www.php.net/error_reporting"><span class="kw3">error_reporting</span></a><span class="br0">(</span>0<span class="br0">)</span><span class="sy0">;</span>
<span class="sy1">?&gt;</span></pre></div></div>
<p>This stops people from seeing that a table doesn’t exist, and so it makes it harder to ‘guess’ table names or perform <a href="https://www.owasp.org/index.php/Blind_SQL_Injection">blind SQL injection attacks</a>.</p>
<ul>
<li>Don’t make your table names really obvious. E.g. ‘tbl_passwords’ is more likely to be guessed in a few tries, compared to ‘super_long_table_name_passwords’. This obviously adds some complexity to your website / web application, but it really does make it harder for hackers to perform blind SQL injection attacks on your service – if they ever do find a vulnerability within it.</li>
<li>Hash passwords and encrypt sensitive data. This is a no brainer really, but older systems still tend to store data in plain text! I actually gained entry into a pretty big education system created by my local council a few years ago. I only did this to prove a point that it could be done – I was however rather shocked to find plaintext passwords displayed in their database along with my personal email address! This really made me up my game with security of data. Oh and they promised me an award for finding this exploit too – which I never got… Awww. <img src="http://localhost:81/wordpress/wp-includes/images/smilies/frownie.png" alt=":(" class="wp-smiley" style="height: 1em; max-height: 1em;"></li>
</ul>
<p>&nbsp;</p>
<p><strong>Security flaw #3:</strong></p>
<h3>Dynamically coding user id’s into forms.</h3>
<p>A lot of people will wonder why this ‘exploit’ is even at number 3 within this list, but believe it or not, I tend to see this a lot whilst browsing website source code. Allow me to demonstrate.</p>
<p><strong>Assuming we have the following exploitable html form:</strong></p>
<div id="wpshdo_6" class="wp-synhighlighter-outer"><div id="wpshdt_6" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_6"></a><a id="wpshat_6" class="wp-synhighlighter-title" href="#codesyntax_6" onclick="javascript:wpsh_toggleBlock(6)" title="Click to show/hide code block">Exploitable html form</a></td><td align="right"><a href="#codesyntax_6" onclick="javascript:wpsh_code(6)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_6" onclick="javascript:wpsh_print(6)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_6" class="wp-synhighlighter-inner" style="display: block;"><pre class="html4strict" style="font-family:monospace;"><span class="sc2">&lt;<a href="http://december.com/html/4/element/form.html"><span class="kw2">form</span></a> <span class="kw3">action</span><span class="sy0">=</span><span class="st0">"update-email.php"</span> <span class="kw3">method</span><span class="sy0">=</span><span class="st0">"POST"</span>&gt;</span>
	<span class="sc2">&lt;<a href="http://december.com/html/4/element/input.html"><span class="kw2">input</span></a> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">"text"</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">"new_email"</span>&gt;</span>
	<span class="sc2">&lt;<a href="http://december.com/html/4/element/input.html"><span class="kw2">input</span></a> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">"hidden"</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">"user_id"</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">"3373"</span>&gt;</span>
	<span class="sc2">&lt;<a href="http://december.com/html/4/element/input.html"><span class="kw2">input</span></a> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">"submit"</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">"Update my email address"</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><a href="http://december.com/html/4/element/form.html"><span class="kw2">form</span></a>&gt;</span></pre></div></div><br>
It looks harmless, right? Wrong. By having that ‘user_id’ field in there, you are basically allowing anyone to change anyone else’s email address. So what you’re saying? It’s just an email address linked to my account right? Yeah possibly (depending on your system) but does your website contain a recover password function too? If it does, you’ve just allowed anyone to gain access to another users account in seconds!<p></p>
<p>Even <strong>Facebook</strong> were vulnerable to this type of attack a few months ago! Crazy right? You’ll be happy to know that the exploit doesn’t work any longer, but you can <a href="http://blog.fin1te.net/post/53949849983/hijacking-a-facebook-account-with-sms">read about how this hack happened on the exploit author’s blog.</a></p>
<p><strong>How to prevent from these types of hacks within my system?</strong></p>
<ul>
<li>Don’t include a user_id field within forms!</li>
<li>Depend on a session instead.</li>
</ul>
<p>&nbsp;</p>
<p><strong><strong>Security flaw #2</strong>:</strong></p>
<h3>Cross site scripting (XSS) attacks</h3>
<p>Do you have a comment form on your website? Yes? Are you validating all inputs as much as possible? No? Well I suggest that you fix this right now as you are prone to users executing Javascript on your page without your knowledge!</p>
<p><strong>Cross site scripting example</strong></p>
<p>Imagine I posted the following string of text as a comment to a website:</p>
<div id="wpshdo_7" class="wp-synhighlighter-outer"><div id="wpshdt_7" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_7"></a><a id="wpshat_7" class="wp-synhighlighter-title" href="#codesyntax_7" onclick="javascript:wpsh_toggleBlock(7)" title="Click to show/hide code block">Simple XSS demo</a></td><td align="right"><a href="#codesyntax_7" onclick="javascript:wpsh_code(7)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_7" onclick="javascript:wpsh_print(7)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_7" class="wp-synhighlighter-inner" style="display: block;"><pre class="javascript" style="font-family:monospace;"><span class="sy0">&lt;</span>script<span class="sy0">&gt;</span>
<span class="kw3">alert</span><span class="br0">(</span><span class="st0">"Hello random user"</span><span class="br0">)</span><span class="sy0">;</span>
<span class="sy0">&lt;/</span>script<span class="sy0">&gt;</span></pre></div></div>
<p>If the website doesn’t prevent against XSS attacks then I would get a lovely alert box like the following every time that page was visited:</p>
<p><a href="http://localhost:81/wordpress/wp-content/uploads/2014/03/Screen-Shot-2014-03-15-at-13.28.14.png"><img class="alignnone size-full wp-image-192" alt="Screen Shot 2014-03-15 at 13.28.14" src="http://localhost:81/wordpress/wp-content/uploads/2014/03/Screen-Shot-2014-03-15-at-13.28.14.png" width="420" height="154"></a></p>
<p>By this point your website users are gonna be like “wuuut? how did that happen?” But in fact, this is actually just the start of the attack. An attacker could go way further than this and steal cookie data from a client’s browser with the following code:</p>
<div id="wpshdo_8" class="wp-synhighlighter-outer"><div id="wpshdt_8" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_8"></a><a id="wpshat_8" class="wp-synhighlighter-title" href="#codesyntax_8" onclick="javascript:wpsh_toggleBlock(8)" title="Click to show/hide code block">Cross site scripting example</a></td><td align="right"><a href="#codesyntax_8" onclick="javascript:wpsh_code(8)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_8" onclick="javascript:wpsh_print(8)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_8" class="wp-synhighlighter-inner" style="display: block;"><pre class="javascript" style="font-family:monospace;"><span class="sy0">&lt;</span>script<span class="sy0">&gt;</span>
	<span class="kw3">alert</span><span class="br0">(</span>document.<span class="me1">cookie</span><span class="br0">)</span><span class="sy0">;</span>
<span class="sy0">&lt;/</span>script<span class="sy0">&gt;</span></pre></div></div>
<p>I recently discovered a slightly more complicated exploit than this on a social networking website called&nbsp;<a href="http://www.unii.com/">Unii</a>. The funny thing is that I managed trigger 380 calls of my exploited code in just a few hours! Now I’m not the type of person that would hack a website in this way, but I could have easily stole 380+ accounts in no time. I reported this exploit to the website administrator and suggested a fix for them.</p>
<p><strong>How to prevent XSS (Cross Site Scripting)?</strong></p>
<p>Within PHP it’s really simple. Just do this every time you’re echoing a string:</p>
<div id="wpshdo_9" class="wp-synhighlighter-outer"><div id="wpshdt_9" class="wp-synhighlighter-expanded"><table border="0" width="100%"><tbody><tr><td align="left" width="80%"><a name="#codesyntax_9"></a><a id="wpshat_9" class="wp-synhighlighter-title" href="#codesyntax_9" onclick="javascript:wpsh_toggleBlock(9)" title="Click to show/hide code block">Prevent XSS attacks with PHP</a></td><td align="right"><a href="#codesyntax_9" onclick="javascript:wpsh_code(9)" title="Show code only"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/code.png"></a>&nbsp;<a href="#codesyntax_9" onclick="javascript:wpsh_print(9)" title="Print code"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/printer.png"></a>&nbsp;<a href="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/About.html" target="_blank" title="Show plugin information"><img border="0" style="border: 0 none" src="http://localhost:81/wordpress/wp-content/plugins/wp-synhighlight/themes/default/images/info.gif"></a>&nbsp;</td></tr></tbody></table></div><div id="wpshdi_9" class="wp-synhighlighter-inner" style="display: block;"><pre class="php" style="font-family:monospace;"><span class="kw2">&lt;?php</span>
<span class="re0">$string</span> <span class="sy0">=</span> <span class="st_h">'&lt;script&gt;alert("Hello random user");&lt;/script&gt;'</span><span class="sy0">;</span>
<span class="kw1">echo</span> <a href="http://www.php.net/htmlspecialchars"><span class="kw3">htmlspecialchars</span></a><span class="br0">(</span><span class="re0">$string</span><span class="sy0">,</span> <span class="kw4">ENT_QUOTES</span><span class="sy0">,</span> <span class="st_h">'UTF-8'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="sy1">?&gt;</span></pre></div></div>
<p>&nbsp;</p>
<p><strong><strong>Security flaw #1</strong>:</strong></p>
<h3>Sloppy coding and lack of code testing.</h3>
<p>Yes, that’s right. The main reason people are hacking your website is because you’re just not testing your code enough before you release it to the wild.</p>
<p>Here are a few pointers that I have for people to create better code for the web:</p>
<ul>
<li>Create automated tests.</li>
<li>Ask real people to test your application.</li>
<li>Get a decent browser such as Google Chrome and use the network inspection tool to monitor traffic, ensuring no sensitive data is transferred between requests.</li>
<li>Create a test site on another domain with the same server setup. Always remember to protect the test site from being accessed by non testers. A good way around this is creating an I.P whitelist.</li>
<li>Always test the unexpected. Not everyone uses your system in the same way.</li>
<li>Always add limits to functions. E.g. Why would a user need to guess their password 5 times in the space of 1 minute? Is there a bot trying to brute force account credentials?</li>
<li>Always Google for multiple code examples and compare your code against them. If your code contains segments from each example you find, chances are it’s going to be less prone to errors.</li>
<li>Research information security every now and then. I like to keep an eye on the <a href="http://security.stackexchange.com/">Information Security website over at StackExchange and look at some of the questions people ask.</a></li>
</ul>
<p><strong>Post conclusion:</strong></p>
<p>Perfecting any sort of web project takes a lot of time and patience. I have been working on websites for over 6 years now and I still tend to find new ways of exploiting them.</p>
<p>Hopefully this post will inspire some of you to think more about your coding style and start writing better code to accommodate for some of the unusual (or unthought of) scenarios that I have pointed out above. You should use this post as a reference for when you’re developing new ideas to accommodate for stopping some of the most common website attacks.</p>
<p>Of course there are many other exploits out there, but these are just some of the more common ones that I tend to come across within websites.</p>
<p>My next post will be a guide on how to create the perfect development workflow with GitHub and an Apache server without any user interaction. This post will also cover more security related aspects of web development, so if you liked this post be sure to check it out <img src="http://localhost:81/wordpress/wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;"></p>
<p>Thanks for reading!</p>
<pre>DISCLAIMER: I only research security vulnerabilities for my own benefit. I am sharing this information with you so that you have a general security checklist for when developing new websites or services.&nbsp;You should not use these methods for performing unlawful attacks on vulnerable websites. Instead, you should notify webmaster's of the security flaw(s) in their website and point them into the right direction on how to fix their coding mistakes. A link to this post would be a good starting point ;)</pre>
			</div>
</article>